import{d as J,g as u,h as K,o as B,b as A,f as W,a as t,t as w,F as E,e as Y,A as h,M as Z,B as x}from"./index-f50d6d08.js";import{_ as tt}from"./navHeader.vue_vue_type_script_setup_true_lang-5f81fcc5.js";import{i as k}from"./index-cbf34b5d.js";import{c as et,a as ot,b as st,d as I}from"./api-e233926e.js";import"./axios-a342f982.js";const nt={class:"main"},lt={class:"stats shadow"},at={class:"stat"},ct=t("div",{class:"stat-figure text-primary"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",class:"inline-block w-8 h-8 stroke-current"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})])],-1),it=t("div",{class:"stat-title"},"总量",-1),rt={class:"stat-value text-secondary"},dt=t("div",{class:"stat-desc"},"标注的总数量",-1),ut={class:"stat"},mt=t("div",{class:"stat-figure text-secondary"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",class:"inline-block w-8 h-8 stroke-current"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})])],-1),pt=t("div",{class:"stat-title"},"工具数量",-1),_t={class:"stat-value text-secondary"},gt=t("div",{class:"stat-desc"},"总得工具数量",-1),ft={class:"stat"},ht=t("div",{class:"stat-figure text-secondary"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",class:"inline-block w-8 h-8 stroke-current"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})])],-1),vt=t("div",{class:"stat-title"},"Sample数量",-1),bt={class:"stat-value text-secondary"},yt=t("div",{class:"stat-desc"},"问题样本数量",-1),wt={class:"flex items-center flex-row justify-center h-20 from-teal-100 via-teal-200 to-teal-300 bg-gradient-to-br"},xt={className:"rounded-3xl m-4 text-center flex flex-row w-full "},kt=t("div",{class:"text-xl font-mono font-bold pt-0.5"}," 13个维度统计 ",-1),Ct=[kt],Bt=t("div",{class:"text-xl font-mono font-bold pt-0.5"}," 统计数据是无的占比 ",-1),At=[Bt],Dt=t("div",{class:"text-xl font-mono font-bold pt-0.5"}," 情感占比统计 ",-1),St=[Dt],jt=t("div",{class:"text-xl font-mono font-bold pt-0.5"}," 标注数量统计 ",-1),zt=[jt],Ot={class:"flex flex-row items-center"},Lt=t("p",{class:"ml-4"},"选择渠道：",-1),Nt=["value","name"],Et={class:"hover:bg-gray-50 flex items-center justify-between px-3 py-1 border-2 rounded-lg cursor-pointer text-sm border-gray-200 group peer-checked:border-blue-500"},It={class:"font-medium text-gray-700"},Mt=t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-9 h-9 text-blue-600 invisible group-[.peer:checked+&]:visible"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),Vt={id:"thirteen",class:"w-full h-96 my-10"},Ft={id:"countNone",class:"w-full h-96 my-10"},Pt={id:"plotSentiment",class:"w-full h-96 my-10"},Tt={id:"labelCount",class:"w-full h-96 my-10"},Gt=J({__name:"statsSentiment",setup(qt){const M=u([]),C=u(0),D=u(0),S=u(0),j=u(!1),z=u(!1),O=u(!1),L=u(!1),V=u(["redhat","weibo","tiktok","shop","test"]),f=u("redhat");async function F(){L.value=!0;const o=await v();console.log(o);const e=o.map(n=>n.prompt_name),l=[...new Set(e)];console.log("标注数量用到的prompts是：",l);const a={};for(let n of o){for(let r of l)a[r]||(a[r]=0);const i=n.prompt_name;l.includes(i)&&(a[i]+=1)}console.log("得到的标注数量统计绘图数据是：",a);const c=Object.keys(a),s=Object.values(a);P(c,s)}const P=(o,e)=>{document.getElementById("labelCount").setAttribute("_echarts_instance_","");var l=document.getElementById("labelCount"),a=k(l);const c=["red","green","blue","yellow","purple","pink","orange","gray","black","brown","cyan","magenta","olive","lime","teal","navy","fuchsia","maroon","aqua","gold","silver"],s=e.map((i,r)=>({value:i,itemStyle:{color:c[r]}})),n={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"value"},yAxis:{type:"category",data:o},series:[{name:"统计",type:"bar",stack:"total",label:{show:!0},emphasis:{focus:"series"},data:s}]};n&&a.setOption(n),window.onresize=()=>{a.resize()}};async function T(){O.value=!0;const o=await v();console.log(o);const e=f.value,l=o.filter(r=>r.prompt.includes(e));console.log("过滤后的数据是：",l);const a=["馅料","味道","包装","便捷程度","场景","服务","价格","口感","烹饪方法","皮","气味","外形","质量缺陷"],c=["积极","消极","中性"],s={};for(let r of l){for(let m of c)s[m]||(s[m]=0);const d=r.messages,b=d[d.length-1];if(b.role==="gpt"){const m=b.content;if(m!=="无"){const y=m.split(`
`);console.log(y);for(let N of y){const p=N.replace(/\(|\)/g,"").split(",");if(p.length===4){p[0].replace(/\s*/g,"");const G=p[1].replace(/\s*/g,"");p[2].replace(/\s*/g,"");const H=p[3].replace(/\s*/g,"");a.includes(G)&&(s[H]+=1)}}}}}console.log("得到的情感统计绘图数据是：",s);const n=Object.keys(s),i=Object.values(s);q(e,n,i)}const q=(o,e,l)=>{document.getElementById("plotSentiment").setAttribute("_echarts_instance_","");var a=document.getElementById("plotSentiment"),c=k(a);const s=["red","green","blue","yellow","purple","pink","orange"],n=l.map((r,d)=>({value:r,itemStyle:{color:s[d]}}));console.log("得到的情感统计绘图数据是：",n);const i={title:{text:o+"情感统计"},xAxis:{type:"category",data:e},yAxis:{type:"value"},series:[{data:n,type:"bar"}]};i&&c.setOption(i),window.onresize=()=>{c.resize()}};async function Q(){z.value=!0;const o=await v();console.log(o);const e=f.value,l=o.filter(n=>n.prompt.includes(e));console.log("过滤后的数据是：",l);const a=[e+"0",e+"1",e+"2",e+"3"],c={};for(let n of l){const i=n.prompt;if(a.includes(i)){const r=n.messages,d=r[r.length-1];d.role==="gpt"&&(d.content==="无"?(c.无效||(c.无效=0),c.无效+=1,console.log("无效数据是",r)):(c.有效||(c.有效=0),c.有效+=1))}}let s=[];for(let n in c)s.push({name:n,value:c[n]});console.log("得到的统计绘图数据是：",s),R(e,s)}const R=(o,e)=>{document.getElementById("countNone").setAttribute("_echarts_instance_","");var l=document.getElementById("countNone"),a=k(l);const c={title:{text:"统计标签是无的数量",subtext:o,left:"center"},tooltip:{trigger:"item"},legend:{orient:"vertical",left:"left"},series:[{name:"Access From",type:"pie",radius:"50%",data:e,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};c&&a.setOption(c),window.onresize=()=>{a.resize()}};async function U(){j.value=!0;const o=await v();console.log(o);const e=f.value,l=o.filter(n=>n.prompt.includes(e));console.log("过滤后的数据是：",l);const a=["馅料","味道","包装","便捷程度","场景","服务","价格","口感","烹饪方法","皮","气味","外形","质量缺陷"],c=[e+"0",e+"1",e+"2",e+"3"],s={};for(let n of l){const i=n.prompt;if(c.includes(i)){s[i]||(s[i]={});for(let _ of a)s[i][_]||(s[i][_]=1)}const r=n.messages,d=r[r.length-1];if(d.role==="gpt"){const _=d.content;if(_!=="无"){const m=_.split(`
`);console.log(m);for(let y of m){const g=y.replace(/\(|\)/g,"").split(",");if(g.length===4){g[0].replace(/\s*/g,"");const p=g[1].replace(/\s*/g,"");if(g[2].replace(/\s*/g,""),g[3].replace(/\s*/g,""),a.includes(p)){if(!s[i])continue;s[i][p]+=1}}}}}}console.log("得到的统计绘图数据是：",s),X(a,s)}const X=(o,e)=>{document.getElementById("thirteen").setAttribute("_echarts_instance_","");var l=document.getElementById("thirteen"),a=k(l);let c=[];for(const n in e){const i=Object.values(e[n]);c.push({name:n,type:"bar",stack:"total",label:{show:!0},emphasis:{focus:"series"},data:i}),console.log("name:",n,"property_values:",i)}const s={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"value"},yAxis:{type:"category",data:o},series:c};s&&a.setOption(s),window.onresize=()=>{a.resize()}};async function v(){try{return(await I({mode:"full",limit:-1})).data}catch(o){console.log(o)}}async function $(o){const e=await I({mode:"sample",limit:o});console.log(e),M.value=e.data,C.value=e.data.length}return K(async()=>{await $(200);const o=await et();C.value=o.data;const e=await ot();console.log(e),D.value=Object.keys(e.data).length;const l=await st({keyword:"empty"});console.log(l),S.value=l.data.length}),(o,e)=>(B(),A(E,null,[W(tt),t("div",nt,[t("div",lt,[t("div",at,[ct,it,t("div",rt,w(C.value),1),dt]),t("div",ut,[mt,pt,t("div",_t,w(D.value),1),gt]),t("div",ft,[ht,vt,t("div",bt,w(S.value),1),yt])]),t("div",wt,[t("div",xt,[t("button",{type:"button",onClick:U,class:"inline-flex text-white bg-gradient-to-r from-purple-500 to-pink-500 hover:bg-gradient-to-l focus:outline-none focus:ring-purple-200 dark:focus:ring-purple-800 font-medium rounded-2xl text-sm px-5 py-2.5 text-center mr-2 mb-2"},Ct),t("button",{type:"button",onClick:Q,class:"text-white bg-[#3b5998] hover:bg-[#3b5998]/90 focus:ring-4 focus:outline-none focus:ring-[#3b5998]/50 font-medium rounded-2xl text-sm px-5 py-2.5 text-center inline-flex items-center dark:focus:ring-[#3b5998]/55 mr-2 mb-2"},At),t("button",{type:"button",onClick:T,class:"text-white bg-[#c4302b] hover:bg-red-500 focus:ring-4 focus:outline-none focus:ring-[#3b5998]/50 font-medium rounded-2xl text-sm px-5 py-2.5 text-center inline-flex items-center dark:focus:ring-[#3b5998]/55 mr-2 mb-2"},St),t("button",{type:"button",onClick:F,class:"text-white bg-[#25D366] hover:bg-green-500 focus:ring-4 focus:outline-none focus:ring-[#3b5998]/50 font-medium rounded-2xl text-sm px-5 py-2.5 text-center inline-flex items-center dark:focus:ring-[#3b5998]/55 mr-2 mb-2"},zt),t("div",Ot,[Lt,(B(!0),A(E,null,Y(V.value,l=>(B(),A("label",null,[h(t("input",{type:"radio",value:l,class:"peer hidden",name:l,"onUpdate:modelValue":e[0]||(e[0]=a=>f.value=a)},null,8,Nt),[[Z,f.value]]),t("div",Et,[t("h2",It,w(l),1),Mt])]))),256))])])]),h(t("div",Vt,null,512),[[x,j.value]]),h(t("div",Ft,null,512),[[x,z.value]]),h(t("div",Pt,null,512),[[x,O.value]]),h(t("div",Tt,null,512),[[x,L.value]])])],64))}});export{Gt as default};
