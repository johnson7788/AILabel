import{a0 as at,I as st,d as it,L as lt,g as q,k as ut,o as G,b as H,f as ct,a as w,F as Q,e as ft,A as Z,M as ht,t as j,C as mt,E as tt}from"./index-f50d6d08.js";import{a as pt,_ as xt}from"./navHeader.vue_vue_type_script_setup_true_lang-5f81fcc5.js";import{s as J}from"./transform-4a56bf00.js";import{a as yt}from"./axios-a342f982.js";import{c as vt}from"./create-8bd90eea.js";var gt={value:function(){}};function rt(){for(var e=0,t=arguments.length,n={},o;e<t;++e){if(!(o=arguments[e]+"")||o in n||/[\s.]/.test(o))throw new Error("illegal type: "+o);n[o]=[]}return new L(n)}function L(e){this._=e}function dt(e,t){return e.trim().split(/^|\s+/).map(function(n){var o="",r=n.indexOf(".");if(r>=0&&(o=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:o}})}L.prototype=rt.prototype={constructor:L,on:function(e,t){var n=this._,o=dt(e+"",n),r,u=-1,f=o.length;if(arguments.length<2){for(;++u<f;)if((r=(e=o[u]).type)&&(r=wt(n[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++u<f;)if(r=(e=o[u]).type)n[r]=et(n[r],e.name,t);else if(t==null)for(r in n)n[r]=et(n[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new L(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var n=new Array(r),o=0,r,u;o<r;++o)n[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(u=this._[e],o=0,r=u.length;o<r;++o)u[o].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var o=this._[e],r=0,u=o.length;r<u;++r)o[r].value.apply(t,n)}};function wt(e,t){for(var n=0,o=e.length,r;n<o;++n)if((r=e[n]).name===t)return r.value}function et(e,t,n){for(var o=0,r=e.length;o<r;++o)if(e[o].name===t){e[o]=gt,e=e.slice(0,o).concat(e.slice(o+1));break}return n!=null&&e.push({name:t,value:n}),e}const _t=Object.freeze(Object.defineProperty({__proto__:null,dispatch:rt},Symbol.toStringTag,{value:"Module"})),Mt=at(_t),bt=Mt.dispatch,K=Math.PI/180,zt={archimedean:ot,rectangular:Bt},O=64,Y=2048;var kt=function(){var e=[256,256],t=St,n=Ct,o=Dt,r=nt,u=nt,f=Tt,g=It,d=ot,k=[],S=1/0,_=bt("word","end"),y=null,T=Math.random,a={},h=Pt;a.canvas=function(s){return arguments.length?(h=$(s),a):h},a.start=function(){var s=v(h()),i=Nt((e[0]>>5)*e[1]),m=null,p=k.length,C=-1,I=[],b=k.map(function(c,l){return c.text=t.call(this,c,l),c.font=n.call(this,c,l),c.style=r.call(this,c,l),c.weight=u.call(this,c,l),c.rotate=f.call(this,c,l),c.size=~~o.call(this,c,l),c.padding=g.call(this,c,l),c}).sort(function(c,l){return l.size-c.size});return y&&clearInterval(y),y=setInterval(E,0),E(),a;function E(){for(var c=Date.now();Date.now()-c<S&&++C<p&&y;){var l=b[C];l.x=e[0]*(T()+.5)>>1,l.y=e[1]*(T()+.5)>>1,Et(s,l,b,C),l.hasText&&M(i,l,m)&&(I.push(l),_.call("word",a,l),m?$t(m,l):m=[{x:l.x+l.x0,y:l.y+l.y0},{x:l.x+l.x1,y:l.y+l.y1}],l.x-=e[0]>>1,l.y-=e[1]>>1)}C>=p&&(a.stop(),_.call("end",a,I,m))}},a.stop=function(){y&&(clearInterval(y),y=null);for(const s of k)delete s.sprite;return a};function v(s){const i=s.getContext("2d",{willReadFrequently:!0});s.width=s.height=1;const m=Math.sqrt(i.getImageData(0,0,1,1).data.length>>2);return s.width=(O<<5)/m,s.height=Y/m,i.fillStyle=i.strokeStyle="red",{context:i,ratio:m}}function M(s,i,m){e[0],e[1];for(var p=i.x,C=i.y,I=Math.sqrt(e[0]*e[0]+e[1]*e[1]),b=d(e),E=T()<.5?1:-1,c=-E,l,F,x;(l=b(c+=E))&&(F=~~l[0],x=~~l[1],!(Math.min(Math.abs(F),Math.abs(x))>=I));)if(i.x=p+F,i.y=C+x,!(i.x+i.x0<0||i.y+i.y0<0||i.x+i.x1>e[0]||i.y+i.y1>e[1])&&(!m||qt(i,m))&&!Ft(i,s,e[0])){for(var z=i.sprite,B=i.width>>5,P=e[0]>>5,D=i.x-(B<<4),N=D&127,A=32-N,U=i.y1-i.y0,V=(i.y+i.y0)*P+(D>>5),R,X=0;X<U;X++){R=0;for(var W=0;W<=B;W++)s[V+W]|=R<<A|(W<B?(R=z[X*B+W])>>>N:0);V+=P}return!0}return!1}return a.timeInterval=function(s){return arguments.length?(S=s??1/0,a):S},a.words=function(s){return arguments.length?(k=s,a):k},a.size=function(s){return arguments.length?(e=[+s[0],+s[1]],a):e},a.font=function(s){return arguments.length?(n=$(s),a):n},a.fontStyle=function(s){return arguments.length?(r=$(s),a):r},a.fontWeight=function(s){return arguments.length?(u=$(s),a):u},a.rotate=function(s){return arguments.length?(f=$(s),a):f},a.text=function(s){return arguments.length?(t=$(s),a):t},a.spiral=function(s){return arguments.length?(d=zt[s]||s,a):d},a.fontSize=function(s){return arguments.length?(o=$(s),a):o},a.padding=function(s){return arguments.length?(g=$(s),a):g},a.random=function(s){return arguments.length?(T=s,a):T},a.on=function(){var s=_.on.apply(_,arguments);return s===_?a:s},a};function St(e){return e.text}function Ct(){return"serif"}function nt(){return"normal"}function Dt(e){return Math.sqrt(e.value)}function Tt(){return(~~(random()*6)-3)*30}function It(){return 1}function Et(e,t,n,o){if(!t.sprite){var r=e.context,u=e.ratio;r.clearRect(0,0,(O<<5)/u,Y/u);var f=0,g=0,d=0,k=n.length;for(--o;++o<k;){t=n[o],r.save(),r.font=t.style+" "+t.weight+" "+~~((t.size+1)/u)+"px "+t.font;const l=r.measureText(t.text),F=-Math.floor(l.width/2);let x=(l.width+1)*u,z=t.size<<1;if(t.rotate){var S=Math.sin(t.rotate*K),_=Math.cos(t.rotate*K),y=x*_,T=x*S,a=z*_,h=z*S;x=Math.max(Math.abs(y+h),Math.abs(y-h))+31>>5<<5,z=~~Math.max(Math.abs(T+a),Math.abs(T-a))}else x=x+31>>5<<5;if(z>d&&(d=z),f+x>=O<<5&&(f=0,g+=d,d=0),g+z>=Y)break;r.translate((f+(x>>1))/u,(g+(z>>1))/u),t.rotate&&r.rotate(t.rotate*K),r.fillText(t.text,F,0),t.padding&&(r.lineWidth=2*t.padding,r.strokeText(t.text,F,0)),r.restore(),t.width=x,t.height=z,t.xoff=f,t.yoff=g,t.x1=x>>1,t.y1=z>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,f+=x}for(var v=r.getImageData(0,0,(O<<5)/u,Y/u).data,M=[];--o>=0;)if(t=n[o],!!t.hasText){for(var s=t.width,i=s>>5,m=t.y1-t.y0,p=0;p<m*i;p++)M[p]=0;if(f=t.xoff,f==null)return;g=t.yoff;for(var C=0,I=-1,b=0;b<m;b++){for(var p=0;p<s;p++){var E=i*b+(p>>5),c=v[(g+b)*(O<<5)+(f+p)<<2]?1<<31-p%32:0;M[E]|=c,C|=c}C?I=b:(t.y0++,m--,b--,g++)}t.y1=t.y0+I,t.sprite=M.slice(0,(t.y1-t.y0)*i)}}}function Ft(e,t,n){n>>=5;for(var o=e.sprite,r=e.width>>5,u=e.x-(r<<4),f=u&127,g=32-f,d=e.y1-e.y0,k=(e.y+e.y0)*n+(u>>5),S,_=0;_<d;_++){S=0;for(var y=0;y<=r;y++)if((S<<g|(y<r?(S=o[_*r+y])>>>f:0))&t[k+y])return!0;k+=n}return!1}function $t(e,t){var n=e[0],o=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>o.x&&(o.x=t.x+t.x1),t.y+t.y1>o.y&&(o.y=t.y+t.y1)}function qt(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function ot(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function Bt(e){var t=4,n=t*e[0]/e[1],o=0,r=0;return function(u){var f=u<0?-1:1;switch(Math.sqrt(1+4*f*u)-f&3){case 0:o+=n;break;case 1:r+=t;break;case 2:o-=n;break;default:r-=t;break}return[o,r]}}function Nt(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function Pt(){return document.createElement("canvas")}function $(e){return typeof e=="function"?e:function(){return e}}const At=st(kt),Rt={class:"flex mb-6"},Wt={class:"flex flex-row items-center"},Ot=w("p",{class:"ml-4"},"模型：",-1),Vt=["value","name"],Lt={class:"hover:bg-gray-50 flex items-center justify-between px-3 py-1 border-2 rounded-lg cursor-pointer text-sm border-gray-200 group peer-checked:border-blue-500"},Yt={class:"font-medium text-gray-700"},Ut=w("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-9 h-9 text-blue-600 invisible group-[.peer:checked+&]:visible"},[w("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),Xt={class:"my-auto mx-2"},Gt={class:"w-11/12 mx-auto h-1/2"},Ht={class:"mx-auto w-20"},Jt=w("div",{id:"wordcloud"},null,-1),ee=it({__name:"testNewWord",setup(e){const{usecache:t}=lt(pt());q(0),q([]);const n=q("Factory模型经过训练过的模型，经过新词训练了2个epoch"),o=q([{name:"Factory",description:"Factory模型经过训练过的模型，经过情感训练了3个epoch"},{name:"DocChat",description:"DocChat模型基于文档的问答模型，没有经过情感训练"},{name:"Yi34B",description:"Yi34B模型，但是参数量大，没有经过情感训练"},{name:"mtdnn",description:"传统的编码器模型"}]),r=q("Factory"),u="https://ai.minitool.fun:6677",f="https://ai.minitool.fun:3326",g=q(!1),d=q(`作为一个不会做饭的人来说，饺子岛真的是留学生非常不错的选择🫰
最喜欢的还是椒麻水煮鱼啦 对于无辣不欢的我们来说 真的是第一选择 很重要的是没有鱼刺！！
肉末茄子也是一个很不错的菜品 软糯糯的茄子配上米饭真的是一绝
吃饭必须要有凉菜 首选的必须是夫妻肺片啦 里面的千层肚真的爱惨 料很足 味道好 配上可乐简直爽爆
而且他们家的服务态度真的真的真的很好 进群还有优惠～
作为一个不会做饭的人来说，饺子岛真的是留学生非常不错的选择🫰
最喜欢的还是椒麻水煮鱼啦 对于无辣不欢的我们来说 真的是第一选择 很重要的是没有鱼刺！！
肉末茄子也是一个很不错的菜品 软糯糯的茄子配上米饭真的是一绝
吃饭必须要有凉菜 首选的必须是夫妻肺片啦 里面的千层肚真的爱惨 料很足 味道好 配上可乐简直爽爆
而且他们家的服务态度真的真的真的很好 进群还有优惠～`);function k(){return"hsla("+~~(360*Math.random())+",60%,60%,1)"}function S(a,{size:h=x=>x.length,word:v=x=>x,marginTop:M=0,marginRight:s=0,marginBottom:i=0,marginLeft:m=0,width:p=1080,height:C=400,maxWords:I=250,fontFamily:b="sans-serif",fontScale:E=15,padding:c=0,rotate:l=0,invalidation:F}={}){const x=a.map(function(D){return[D.term,D.normalized,D.normalized]}).slice(0,I).map(([D,N,A])=>({text:v(D),size:N,freq:v(A)})),z=vt("svg").attr("viewBox",[0,0,p,C]).attr("width",p).attr("font-family",b).attr("text-anchor","middle").attr("style","max-width: 100%; height: auto; height: intrinsic;"),B=z.append("g").attr("transform",`translate(${m},${M})`),P=At().size([p-m-s,C-M-i]).words(x).padding(c).rotate(l).font(b).fontSize(D=>Math.sqrt(D.size)*E).on("word",({size:D,x:N,y:A,rotate:U,text:V,freq:R})=>{B.append("text").attr("font-size",D).attr("transform",`translate(${N},${A}) rotate(${U})`).attr("opacity",1).attr("fill",k()).text(V).on("mouseover",function(){J(this).attr("opacity",.6)}).on("mouseout",function(){J(this).attr("opacity",1)}).append("title").text("Frequency: "+R)});return P.start(),F&&F.then(()=>P.stop()),z.node()}function _(a){console.log("要绘图的数据是:",a),g.value=!0;const h=100,v=600;let M=[];for(let i of a){const m=i.length*6,p=i.length*2;M.push({term:i,frequency:m,normalized:p})}console.log("绘图数据是:",M);const s=S(M,{marginTop:h,height:v});J("#wordcloud").append(()=>s)}async function y(){if(d.value===""){tt({title:"提示",message:"请输入内容",type:"warning"});return}const a=new Date().getTime(),h=await T(d.value);console.log("耗时:",new Date().getTime()-a,"ms"),_(h)}async function T(a){let h=u;r.value==="mtdnn"&&(h=f);try{return(await yt.post(h+"/new_word_discovery/predict",{content:a,model:r.value,usecache:t.value})).data.data}catch(v){console.log(v),tt({title:"Error",message:"处理请求接口失败"})}}return ut(r,a=>{n.value=o.value.find(h=>h.name===a).description}),(a,h)=>(G(),H(Q,null,[ct(xt),w("div",Rt,[w("div",Wt,[Ot,(G(!0),H(Q,null,ft(o.value,v=>(G(),H("label",null,[Z(w("input",{type:"radio",value:v.name,class:"peer hidden",name:v.name,"onUpdate:modelValue":h[0]||(h[0]=M=>r.value=M)},null,8,Vt),[[ht,r.value]]),w("div",Lt,[w("h2",Yt,j(v.name),1),Ut])]))),256))]),w("div",Xt,[w("span",null,j(n.value),1)])]),w("div",Gt,[Z(w("textarea",{placeholder:"请输入一大段文本，系统自动发现新词",class:"textarea textarea-bordered textarea-lg w-full","onUpdate:modelValue":h[1]||(h[1]=v=>d.value=v)},null,512),[[mt,d.value]])]),w("div",Ht,[w("button",{class:"btn btn-success mx-auto",onClick:h[2]||(h[2]=v=>y())},"确认")]),Jt],64))}});export{ee as default};
