import{d as O,g as i,h as z,r as y,o as c,b as u,f as n,a as e,A as r,C as m,P as E,G as k,w as v,j as V,B as F,F as M,e as D,t as C,E as f,U as P}from"./index-f50d6d08.js";import{_ as q}from"./navHeader.vue_vue_type_script_setup_true_lang-5f81fcc5.js";import{c as G,a as L,b as Q,u as W,d as H,q as I,f as J}from"./api-e233926e.js";import"./axios-a342f982.js";const K={class:"main"},R={class:"rounded-t mb-0 px-4 py-3 border-0"},X={class:"flex flex-wrap items-center"},Y=e("div",{class:"relative w-full px-1 max-w-full flex-grow flex-1"},[e("h3",{class:"font-semibold text-base text-blueGray-700 center"},"为了不卡顿，初始仅显示最后200条数据，点击按钮获可以取所有数据")],-1),Z={class:"relative w-full px-4 max-w-full flex-grow flex-1 text-right"},ee={class:"container bg-slate-600 mx-auto rounded-lg"},te={class:"sm:flex items-center bg-white rounded-lg overflow-hidden px-2 py-1 justify-between"},oe={class:"ms:flex items-center px-2 rounded-lg space-x-4 mx-auto"},ae=P('<option value="all" selected>all</option><option value="prompt_name">prompt_name</option><option value="prompt">prompt</option><option value="tools">tools</option><option value="messages">messages</option>',5),le=[ae],se={class:"fixed z-20 h-screen w-1/4 bg-green-200 p-8 right-0 top-0 overflow-auto","x-transition:enter":"transition ease-out duration-300","x-transition:enter-start":"-translate-x-72","x-transition:enter-end":"translate-x-0","x-transition:leave":"transition ease-in duration-300 ","x-transition:leave-start":"translate-x-0","x-transition:leave-end":"-translate-x-72","x-cloak":""},ne={class:"h-screen"},ie=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"black",class:"w-6 h-6"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1),re=[ie],de={class:"form-control w-full max-w-xs mb-6"},pe=e("div",{class:"label"},[e("span",{class:"label-text"},"Prompt name")],-1),ce={class:"form-control w-full max-w-xs mb-6"},ue=e("div",{class:"label"},[e("span",{class:"label-text"},"Prompt")],-1),me={class:"label"},xe={class:"label-text"},_e=["onUpdate:modelValue"],ve={class:"label"},fe={class:"label-text"},be=["onUpdate:modelValue"],Me=O({__name:"review",setup(we){const d=i([]),U=i(0),T=i(0),$=i(0),x=i(!1),l=i({prompt:"",prompt_name:"",messages:"",tools:"",id:""});i(!1);const b=i("all"),w=i("");async function N(){const a=await I({mode:"sample",limit:-1,keyword:w.value,field:b.value});console.log(a),d.value=a.data}function S(a){const t=d.value[a];console.log("修改数据,索引是",a,"数据是",t),x.value=!0,l.value=t}async function j(){const a=await W({id:l.value.id,prompt:l.value.prompt,prompt_name:l.value.prompt_name,messages:l.value.messages,tools:l.value.tools});console.log("更新数据的结果是",a),a.code===0?(f({message:"更新数据成功",type:"info"}),x.value=!1,await _(200),l.value={prompt:"",prompt_name:"",messages:"",tools:"",id:""}):f({message:`更新数据失败，${a.msg}，请检查接口`,type:"info"})}async function B(a){console.log("删除数据",a);const s=d.value[a].id;(await J({id:s})).code===0?(f.info("删除数据成功"),await _(200)):f.error("删除数据失败")}async function _(a){const t=await H({mode:"sample",limit:a});console.log(t),d.value=t.data}return z(async()=>{await _(200);const a=await G();U.value=a.data;const t=await L();console.log(t),T.value=Object.keys(t.data).length;const s=await Q({keyword:"empty"});console.log(s),$.value=s.data.length}),(a,t)=>{const s=y("el-table-column"),g=y("el-button"),A=y("el-table");return c(),u(M,null,[n(q),e("div",K,[e("div",R,[e("div",X,[Y,e("div",Z,[e("button",{class:"bg-indigo-400 text-white active:bg-indigo-600 text-xs font-bold uppercase px-4 py-3 rounded outline-none focus:outline-none mr-1 mb-1 ease-linear transition-all duration-150",type:"button",onClick:t[0]||(t[0]=o=>_(-1))},"获取所有数据")])]),e("div",ee,[e("form",null,[e("div",te,[r(e("input",{class:"text-base text-gray-400 flex-grow outline-none px-2",type:"text","onUpdate:modelValue":t[1]||(t[1]=o=>w.value=o),placeholder:"搜索已标注数据"},null,512),[[m,w.value]]),e("div",oe,[r(e("select",{id:"field",class:"text-base text-gray-800 outline-none border-2 px-4 py-2 rounded-lg","onUpdate:modelValue":t[2]||(t[2]=o=>b.value=o)},le,512),[[E,b.value]]),e("button",{onClick:k(N,["prevent"]),class:"bg-indigo-500 text-white text-base rounded-lg px-4 py-2 font-thin"},"搜索")])])])])]),n(A,{data:d.value,style:{width:"100%"},class:"mt-10"},{default:v(()=>[n(s,{prop:"id",label:"id",width:"150"}),n(s,{prop:"time",label:"time",width:"150"}),n(s,{prop:"prompt_name",label:"prompt_name",width:"150"}),n(s,{prop:"prompt",label:"prompt",width:"150"}),n(s,{prop:"tools_concat",label:"tools_concat",width:"150"}),n(s,{prop:"messages_concat",label:"messages_concat",width:"700"}),n(s,{fixed:"right",label:"Operations",width:"120"},{default:v(o=>[n(g,{link:"",type:"primary",size:"small",onClick:k(p=>S(o.$index),["prevent"])},{default:v(()=>[V("修改")]),_:2},1032,["onClick"]),n(g,{link:"",type:"primary",size:"small",onClick:k(p=>B(o.$index),["prevent"])},{default:v(()=>[V("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),r(e("nav",se,[e("div",ne,[e("button",{onClick:t[3]||(t[3]=o=>x.value=!1)},re),e("label",de,[pe,r(e("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=o=>l.value.prompt_name=o),placeholder:"Type here",class:"input input-bordered w-full max-w-xs"},null,512),[[m,l.value.prompt_name]])]),e("label",ce,[ue,r(e("input",{type:"text","onUpdate:modelValue":t[5]||(t[5]=o=>l.value.prompt=o),placeholder:"Type here",class:"input input-bordered w-full max-w-xs"},null,512),[[m,l.value.prompt]])]),(c(!0),u(M,null,D(l.value.messages,(o,p)=>(c(),u("label",{class:"form-control w-full max-w-xs mb-6",key:p},[e("div",me,[e("span",xe,C(o.role)+": "+C(o.id),1)]),r(e("textarea",{type:"text","onUpdate:modelValue":h=>o.content=h,placeholder:"Type here",class:"input input-bordered w-full max-w-xs"},null,8,_e),[[m,o.content]])]))),128)),(c(!0),u(M,null,D(l.value.tools,(o,p)=>(c(),u("label",{class:"form-control w-full max-w-xs mb-6",key:p},[e("div",ve,[e("span",fe,C(o.description),1)]),r(e("input",{type:"text","onUpdate:modelValue":h=>o.name=h,placeholder:"Type here",class:"input input-bordered w-full max-w-xs"},null,8,be),[[m,o.name]])]))),128)),e("div",{class:"flex justify-center pb-10"},[e("button",{class:"btn btn-outline btn-info mt-6",onClick:j},"确认")])])],512),[[F,x.value]])])],64)}}});export{Me as default};
