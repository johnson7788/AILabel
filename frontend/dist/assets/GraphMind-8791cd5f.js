import{u as O}from"./store-93e037d2.js";import{_ as U}from"./navbar.vue_vue_type_script_setup_true_lang-6e8001dc.js";import{s as T}from"./transform-4a56bf00.js";import{z as V}from"./zoom-558520b2.js";import{N as X,h as I}from"./index-43d88f95.js";import{d as D,g as b,h as Y,k as q,o as S,b as $,a as y,q as F,s as G,_ as H,L as J,f as K,z as W,c as Q,F as Z,E as C}from"./index-f50d6d08.js";import{w as tt,s as et,c as j}from"./array-4492e866.js";import{x as nt,y as at}from"./point-e88f89db.js";import"./axios-a342f982.js";import"./pointer-b52b12f8.js";import"./nodrag-71d5223e.js";function rt(n,e){return n.parent===e.parent?1:2}function L(n){var e=n.children;return e?e[0]:n.t}function M(n){var e=n.children;return e?e[e.length-1]:n.t}function it(n,e,a){var c=a/(e.i-n.i);e.c-=c,e.s+=a,n.c+=c,e.z+=a,e.m+=a}function st(n){for(var e=0,a=0,c=n.children,u=c.length,h;--u>=0;)h=c[u],h.z+=e,h.m+=e,e+=h.s+(a+=h.c)}function ot(n,e,a){return n.a.parent===e.parent?n.a:a}function E(n,e){this._=n,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}E.prototype=Object.create(X.prototype);function lt(n){for(var e=new E(n,0),a,c=[e],u,h,i,f;a=c.pop();)if(h=a._.children)for(a.children=new Array(f=h.length),i=f-1;i>=0;--i)c.push(u=a.children[i]=new E(h[i],i)),u.parent=a;return(e.parent=new E(null,0)).children=[e],e}function ct(){var n=rt,e=1,a=1,c=null;function u(t){var d=lt(t);if(d.eachAfter(h),d.parent.m=-d.z,d.eachBefore(i),c)t.eachBefore(_);else{var m=t,l=t,p=t;t.eachBefore(function(g){g.x<m.x&&(m=g),g.x>l.x&&(l=g),g.depth>p.depth&&(p=g)});var s=m===l?1:n(m,l)/2,o=s-m.x,x=e/(l.x+s+o),w=a/(p.depth||1);t.eachBefore(function(g){g.x=(g.x+o)*x,g.y=g.depth*w})}return t}function h(t){var d=t.children,m=t.parent.children,l=t.i?m[t.i-1]:null;if(d){st(t);var p=(d[0].z+d[d.length-1].z)/2;l?(t.z=l.z+n(t._,l._),t.m=t.z-p):t.z=p}else l&&(t.z=l.z+n(t._,l._));t.parent.A=f(t,l,t.parent.A||m[0])}function i(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function f(t,d,m){if(d){for(var l=t,p=t,s=d,o=l.parent.children[0],x=l.m,w=p.m,g=s.m,z=o.m,k;s=M(s),l=L(l),s&&l;)o=L(o),p=M(p),p.a=t,k=s.z+g-l.z-x+n(s._,l._),k>0&&(it(ot(s,t,m),t,k),x+=k,w+=k),g+=s.m,x+=l.m,z+=o.m,w+=p.m;s&&!M(p)&&(p.t=s,p.m+=g-w),l&&!L(o)&&(o.t=l,o.m+=x-z,m=t)}return m}function _(t){t.x*=e,t.y=t.depth*a}return u.separation=function(t){return arguments.length?(n=t,u):n},u.size=function(t){return arguments.length?(c=!1,e=+t[0],a=+t[1],u):c?null:[e,a]},u.nodeSize=function(t){return arguments.length?(c=!0,e=+t[0],a=+t[1],u):c?[e,a]:null},u}class ut{constructor(e,a){this._context=e,this._x=a}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,a){switch(e=+e,a=+a,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,a):this._context.moveTo(e,a);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,a,e,a):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+a)/2,e,this._y0,e,a);break}}this._x0=e,this._y0=a}}function dt(n){return new ut(n,!0)}function ht(n){return n.source}function ft(n){return n.target}function pt(n){let e=ht,a=ft,c=nt,u=at,h=null,i=null,f=tt(_);function _(){let t;const d=et.call(arguments),m=e.apply(this,d),l=a.apply(this,d);if(h==null&&(i=n(t=f())),i.lineStart(),d[0]=m,i.point(+c.apply(this,d),+u.apply(this,d)),d[0]=l,i.point(+c.apply(this,d),+u.apply(this,d)),i.lineEnd(),t)return i=null,t+""||null}return _.source=function(t){return arguments.length?(e=t,_):e},_.target=function(t){return arguments.length?(a=t,_):a},_.x=function(t){return arguments.length?(c=typeof t=="function"?t:j(+t),_):c},_.y=function(t){return arguments.length?(u=typeof t=="function"?t:j(+t),_):u},_.context=function(t){return arguments.length?(t==null?h=i=null:i=n(h=t),_):h},_}function v(){return pt(dt)}const _t=n=>(F("data-v-623f3a3c"),n=n(),G(),n),mt={class:"relative w-full h-screen bg-gray-50"},gt=_t(()=>y("defs",null,[y("marker",{id:"arrowhead",viewBox:"0 0 10 10",refX:"8",refY:"5",markerWidth:"6",markerHeight:"6",orient:"auto"},[y("path",{d:"M 0 0 L 10 5 L 0 10 z",class:"fill-gray-400"})])],-1)),yt=[gt],xt=D({__name:"d3mind",props:{data:{}},setup(n){const e=n,a=b(null),c=b(null),u=b(window.innerWidth),h=b(window.innerHeight);let i,f;const _=V().scaleExtent([.1,4]).on("zoom",s=>{f.attr("transform",s.transform)});function t(s,o){if(!c.value||!o.data.description)return;T(c.value).style("opacity",1).style("left",`${s.pageX+10}px`).style("top",`${s.pageY-150}px`).html(o.data.description)}function d(){c.value&&T(c.value).style("opacity",0)}async function m(s,o){s.stopPropagation(),!o.children&&o._children?(o.children=o._children,o._children=null):o.children&&(o._children=o.children,o.children=null),l(o)}function l(s){const w=u.value-200;ct().nodeSize([180,w/2])(i);const z=i.descendants(),k=i.links();z.forEach(r=>{r.y=r.depth*180});const A=f.selectAll(".link").data(k,r=>r.target.id),R=A.enter().append("path").attr("class","link").attr("d",v().x(r=>r.y).y(r=>r.x)).attr("fill","none").attr("stroke","#999").attr("stroke-width",1.5);A.merge(R).transition().duration(750).attr("d",v().x(r=>r.y).y(r=>r.x)),A.exit().transition().duration(750).attr("d",v().x(r=>r.y).y(r=>r.x)).remove();const N=f.selectAll("g.node").data(z,r=>r.id||(r.id=++p)),B=N.enter().append("g").attr("class","node").attr("transform",()=>`translate(${s.y0||s.y},${s.x0||s.x})`).on("click",m).on("mouseover",t).on("mouseout",d);B.append("circle").attr("r",6).attr("class","node-circle").attr("fill",r=>r.children||r._children?"#60A5FA":"#34D399"),B.append("text").attr("dy",".31em").attr("x",r=>r.children||r._children?-10:10).attr("text-anchor",r=>r.children||r._children?"end":"start").text(r=>r.data.name).attr("class","text-sm fill-gray-700"),N.merge(B).transition().duration(750).attr("transform",r=>`translate(${r.y},${r.x})`).select("circle").attr("fill",r=>r.children||r._children?"#60A5FA":"#34D399"),N.exit().transition().duration(750).attr("transform",()=>`translate(${s.y},${s.x})`).remove().select("circle").attr("r",0),z.forEach(r=>{r.x0=r.x,r.y0=r.y})}let p=0;return Y(()=>{const s=T(a.value);f=s.append("g").attr("transform","translate(100,50)"),s.call(_),i=I(e.data),i.x0=h.value/2,i.y0=0,i.descendants().forEach(o=>{o.depth>0&&o.children&&(o._children=o.children,o.children=null)}),l(i)}),q(()=>e.data,s=>{i=I(s),i.x0=h.value/2,i.y0=0,l(i)}),window.addEventListener("resize",()=>{u.value=window.innerWidth,h.value=window.innerHeight,l(i)}),(s,o)=>(S(),$("div",mt,[(S(),$("svg",{ref_key:"svg",ref:a,class:"w-full h-full"},yt,512)),y("div",{ref_key:"tooltip",ref:c,class:"absolute pointer-events-none bg-white p-2 rounded shadow-lg border border-gray-200 text-sm opacity-0 transition-opacity duration-200"},null,512)]))}});const wt=H(xt,[["__scopeId","data-v-623f3a3c"]]),P=n=>(F("data-v-f643d5e1"),n=n(),G(),n),kt={class:"min-h-screen bg-gray-50 py-2"},zt={class:"container relative"},bt={class:"flex flex-col items-center justify-center mb-4"},St=["disabled"],Et={key:0,class:"flex items-center justify-center space-x-2"},$t=P(()=>y("svg",{class:"w-8 h-8 animate-spin text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[y("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4",class:"opacity-25"}),y("path",{fill:"currentColor",d:"M4 12a8 8 0 0116 0",class:"opacity-75"})],-1)),At=P(()=>y("span",{class:"text-xl font-semibold text-blue-500"},"Loading...",-1)),Nt=[$t,At],Bt=D({__name:"GraphMind",setup(n){const{data_dir:e}=J(O()),a="https://open.minitool.fun:15314",c=b(),u=b(!1),h=async()=>{c.value=null;try{u.value=!0;const i=await fetch(`${a}/api/space_design_method2`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data_dir:e.value})}),f=await i.json();console.log(f),i.ok&&f.code==0?(C({title:"成功",message:"获取数据成功",type:"success"}),c.value=f.data.nodes):C({title:"失败",message:f.msg||"获取内容失败",type:"error"})}catch{C({title:"失败",message:"请求失败，请检查网络连接",type:"error"})}finally{u.value=!1}};return(i,f)=>(S(),$(Z,null,[K(U),y("div",kt,[y("div",zt,[y("div",bt,[y("button",{class:"button mx-auto z-20",disabled:u.value,onClick:h},"开始体验",8,St)]),u.value?(S(),$("div",Et,Nt)):W("",!0),c.value?(S(),Q(wt,{key:1,data:c.value,class:"w-full h-full"},null,8,["data"])):W("",!0)])])],64))}});const Rt=H(Bt,[["__scopeId","data-v-f643d5e1"]]);export{Rt as default};
