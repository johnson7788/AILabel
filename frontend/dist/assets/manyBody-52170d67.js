import{t as T,d as q}from"./transform-4a56bf00.js";function B(t){const n=+this._x.call(null,t),i=+this._y.call(null,t);return P(this.cover(n,i),n,i,t)}function P(t,n,i,a){if(isNaN(n)||isNaN(i))return t;var r,h=t._root,l={data:a},y=t._x0,x=t._y0,u=t._x1,v=t._y1,g,w,s,_,e,c,f,o;if(!h)return t._root=l,t;for(;h.length;)if((e=n>=(g=(y+u)/2))?y=g:u=g,(c=i>=(w=(x+v)/2))?x=w:v=w,r=h,!(h=h[f=c<<1|e]))return r[f]=l,t;if(s=+t._x.call(null,h.data),_=+t._y.call(null,h.data),n===s&&i===_)return l.next=h,r?r[f]=l:t._root=l,t;do r=r?r[f]=new Array(4):t._root=new Array(4),(e=n>=(g=(y+u)/2))?y=g:u=g,(c=i>=(w=(x+v)/2))?x=w:v=w;while((f=c<<1|e)===(o=(_>=w)<<1|s>=g));return r[o]=h,r[f]=l,t}function F(t){var n,i,a=t.length,r,h,l=new Array(a),y=new Array(a),x=1/0,u=1/0,v=-1/0,g=-1/0;for(i=0;i<a;++i)isNaN(r=+this._x.call(null,n=t[i]))||isNaN(h=+this._y.call(null,n))||(l[i]=r,y[i]=h,r<x&&(x=r),r>v&&(v=r),h<u&&(u=h),h>g&&(g=h));if(x>v||u>g)return this;for(this.cover(x,u).cover(v,g),i=0;i<a;++i)P(this,l[i],y[i],t[i]);return this}function R(t,n){if(isNaN(t=+t)||isNaN(n=+n))return this;var i=this._x0,a=this._y0,r=this._x1,h=this._y1;if(isNaN(i))r=(i=Math.floor(t))+1,h=(a=Math.floor(n))+1;else{for(var l=r-i||1,y=this._root,x,u;i>t||t>=r||a>n||n>=h;)switch(u=(n<a)<<1|t<i,x=new Array(4),x[u]=y,y=x,l*=2,u){case 0:r=i+l,h=a+l;break;case 1:i=r-l,h=a+l;break;case 2:r=i+l,a=h-l;break;case 3:i=r-l,a=h-l;break}this._root&&this._root.length&&(this._root=y)}return this._x0=i,this._y0=a,this._x1=r,this._y1=h,this}function S(){var t=[];return this.visit(function(n){if(!n.length)do t.push(n.data);while(n=n.next)}),t}function X(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function M(t,n,i,a,r){this.node=t,this.x0=n,this.y0=i,this.x1=a,this.y1=r}function Y(t,n,i){var a,r=this._x0,h=this._y0,l,y,x,u,v=this._x1,g=this._y1,w=[],s=this._root,_,e;for(s&&w.push(new M(s,r,h,v,g)),i==null?i=1/0:(r=t-i,h=n-i,v=t+i,g=n+i,i*=i);_=w.pop();)if(!(!(s=_.node)||(l=_.x0)>v||(y=_.y0)>g||(x=_.x1)<r||(u=_.y1)<h))if(s.length){var c=(l+x)/2,f=(y+u)/2;w.push(new M(s[3],c,f,x,u),new M(s[2],l,f,c,u),new M(s[1],c,y,x,f),new M(s[0],l,y,c,f)),(e=(n>=f)<<1|t>=c)&&(_=w[w.length-1],w[w.length-1]=w[w.length-1-e],w[w.length-1-e]=_)}else{var o=t-+this._x.call(null,s.data),N=n-+this._y.call(null,s.data),p=o*o+N*N;if(p<i){var m=Math.sqrt(i=p);r=t-m,h=n-m,v=t+m,g=n+m,a=s.data}}return a}function C(t){if(isNaN(v=+this._x.call(null,t))||isNaN(g=+this._y.call(null,t)))return this;var n,i=this._root,a,r,h,l=this._x0,y=this._y0,x=this._x1,u=this._y1,v,g,w,s,_,e,c,f;if(!i)return this;if(i.length)for(;;){if((_=v>=(w=(l+x)/2))?l=w:x=w,(e=g>=(s=(y+u)/2))?y=s:u=s,n=i,!(i=i[c=e<<1|_]))return this;if(!i.length)break;(n[c+1&3]||n[c+2&3]||n[c+3&3])&&(a=n,f=c)}for(;i.data!==t;)if(r=i,!(i=i.next))return this;return(h=i.next)&&delete i.next,r?(h?r.next=h:delete r.next,this):n?(h?n[c]=h:delete n[c],(i=n[0]||n[1]||n[2]||n[3])&&i===(n[3]||n[2]||n[1]||n[0])&&!i.length&&(a?a[f]=i:this._root=i),this):(this._root=h,this)}function G(t){for(var n=0,i=t.length;n<i;++n)this.remove(t[n]);return this}function H(){return this._root}function J(){var t=0;return this.visit(function(n){if(!n.length)do++t;while(n=n.next)}),t}function K(t){var n=[],i,a=this._root,r,h,l,y,x;for(a&&n.push(new M(a,this._x0,this._y0,this._x1,this._y1));i=n.pop();)if(!t(a=i.node,h=i.x0,l=i.y0,y=i.x1,x=i.y1)&&a.length){var u=(h+y)/2,v=(l+x)/2;(r=a[3])&&n.push(new M(r,u,v,y,x)),(r=a[2])&&n.push(new M(r,h,v,u,x)),(r=a[1])&&n.push(new M(r,u,l,y,v)),(r=a[0])&&n.push(new M(r,h,l,u,v))}return this}function L(t){var n=[],i=[],a;for(this._root&&n.push(new M(this._root,this._x0,this._y0,this._x1,this._y1));a=n.pop();){var r=a.node;if(r.length){var h,l=a.x0,y=a.y0,x=a.x1,u=a.y1,v=(l+x)/2,g=(y+u)/2;(h=r[0])&&n.push(new M(h,l,y,v,g)),(h=r[1])&&n.push(new M(h,v,y,x,g)),(h=r[2])&&n.push(new M(h,l,g,v,u)),(h=r[3])&&n.push(new M(h,v,g,x,u))}i.push(a)}for(;a=i.pop();)t(a.node,a.x0,a.y0,a.x1,a.y1);return this}function O(t){return t[0]}function U(t){return arguments.length?(this._x=t,this):this._x}function V(t){return t[1]}function W(t){return arguments.length?(this._y=t,this):this._y}function Q(t,n,i){var a=new I(n??O,i??V,NaN,NaN,NaN,NaN);return t==null?a:a.addAll(t)}function I(t,n,i,a,r,h){this._x=t,this._y=n,this._x0=i,this._y0=a,this._x1=r,this._y1=h,this._root=void 0}function D(t){for(var n={data:t.data},i=n;t=t.next;)i=i.next={data:t.data};return n}var A=Q.prototype=I.prototype;A.copy=function(){var t=new I(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root,i,a;if(!n)return t;if(!n.length)return t._root=D(n),t;for(i=[{source:n,target:t._root=new Array(4)}];n=i.pop();)for(var r=0;r<4;++r)(a=n.source[r])&&(a.length?i.push({source:a,target:n.target[r]=new Array(4)}):n.target[r]=D(a));return t};A.add=B;A.addAll=F;A.cover=R;A.data=S;A.extent=X;A.find=Y;A.remove=C;A.removeAll=G;A.root=H;A.size=J;A.visit=K;A.visitAfter=L;A.x=U;A.y=W;function z(t){return function(){return t}}function b(t){return(t()-.5)*1e-6}const Z=1664525,$=1013904223,E=4294967296;function tt(){let t=1;return()=>(t=(Z*t+$)%E)/E}function nt(t){return t.x}function it(t){return t.y}var et=10,rt=Math.PI*(3-Math.sqrt(5));function st(t){var n,i=1,a=.001,r=1-Math.pow(a,1/300),h=0,l=.6,y=new Map,x=T(g),u=q("tick","end"),v=tt();t==null&&(t=[]);function g(){w(),u.call("tick",n),i<a&&(x.stop(),u.call("end",n))}function w(e){var c,f=t.length,o;e===void 0&&(e=1);for(var N=0;N<e;++N)for(i+=(h-i)*r,y.forEach(function(p){p(i)}),c=0;c<f;++c)o=t[c],o.fx==null?o.x+=o.vx*=l:(o.x=o.fx,o.vx=0),o.fy==null?o.y+=o.vy*=l:(o.y=o.fy,o.vy=0);return n}function s(){for(var e=0,c=t.length,f;e<c;++e){if(f=t[e],f.index=e,f.fx!=null&&(f.x=f.fx),f.fy!=null&&(f.y=f.fy),isNaN(f.x)||isNaN(f.y)){var o=et*Math.sqrt(.5+e),N=e*rt;f.x=o*Math.cos(N),f.y=o*Math.sin(N)}(isNaN(f.vx)||isNaN(f.vy))&&(f.vx=f.vy=0)}}function _(e){return e.initialize&&e.initialize(t,v),e}return s(),n={tick:w,restart:function(){return x.restart(g),n},stop:function(){return x.stop(),n},nodes:function(e){return arguments.length?(t=e,s(),y.forEach(_),n):t},alpha:function(e){return arguments.length?(i=+e,n):i},alphaMin:function(e){return arguments.length?(a=+e,n):a},alphaDecay:function(e){return arguments.length?(r=+e,n):+r},alphaTarget:function(e){return arguments.length?(h=+e,n):h},velocityDecay:function(e){return arguments.length?(l=1-e,n):1-l},randomSource:function(e){return arguments.length?(v=e,y.forEach(_),n):v},force:function(e,c){return arguments.length>1?(c==null?y.delete(e):y.set(e,_(c)),n):y.get(e)},find:function(e,c,f){var o=0,N=t.length,p,m,k,d,j;for(f==null?f=1/0:f*=f,o=0;o<N;++o)d=t[o],p=e-d.x,m=c-d.y,k=p*p+m*m,k<f&&(j=d,f=k);return j},on:function(e,c){return arguments.length>1?(u.on(e,c),n):u.on(e)}}}function ht(){var t,n,i,a,r=z(-30),h,l=1,y=1/0,x=.81;function u(s){var _,e=t.length,c=Q(t,nt,it).visitAfter(g);for(a=s,_=0;_<e;++_)n=t[_],c.visit(w)}function v(){if(t){var s,_=t.length,e;for(h=new Array(_),s=0;s<_;++s)e=t[s],h[e.index]=+r(e,s,t)}}function g(s){var _=0,e,c,f=0,o,N,p;if(s.length){for(o=N=p=0;p<4;++p)(e=s[p])&&(c=Math.abs(e.value))&&(_+=e.value,f+=c,o+=c*e.x,N+=c*e.y);s.x=o/f,s.y=N/f}else{e=s,e.x=e.data.x,e.y=e.data.y;do _+=h[e.data.index];while(e=e.next)}s.value=_}function w(s,_,e,c){if(!s.value)return!0;var f=s.x-n.x,o=s.y-n.y,N=c-_,p=f*f+o*o;if(N*N/x<p)return p<y&&(f===0&&(f=b(i),p+=f*f),o===0&&(o=b(i),p+=o*o),p<l&&(p=Math.sqrt(l*p)),n.vx+=f*s.value*a/p,n.vy+=o*s.value*a/p),!0;if(s.length||p>=y)return;(s.data!==n||s.next)&&(f===0&&(f=b(i),p+=f*f),o===0&&(o=b(i),p+=o*o),p<l&&(p=Math.sqrt(l*p)));do s.data!==n&&(N=h[s.data.index]*a/p,n.vx+=f*N,n.vy+=o*N);while(s=s.next)}return u.initialize=function(s,_){t=s,i=_,v()},u.strength=function(s){return arguments.length?(r=typeof s=="function"?s:z(+s),v(),u):r},u.distanceMin=function(s){return arguments.length?(l=s*s,u):Math.sqrt(l)},u.distanceMax=function(s){return arguments.length?(y=s*s,u):Math.sqrt(y)},u.theta=function(s){return arguments.length?(x=s*s,u):Math.sqrt(x)},u}export{z as c,b as j,ht as m,Q as q,st as s};
