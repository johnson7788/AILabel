import{d as O,L as A,g as a,h as U,o as u,b as i,f as G,a as e,A as g,C as M,B as P,F as m,e as k,t as _,p as R,i as H,E as v}from"./index-f50d6d08.js";import{a as J,u as K,_ as W}from"./navHeader.vue_vue_type_script_setup_true_lang-f1ba1dcd.js";import{g as X,a as Y,m as Z,b as ee,n as te,o as $}from"./api-a3faf747.js";import"./axios-a342f982.js";const oe={class:"main flex flex-col w-full lg:flex-row"},se={class:"left w-3/5 grid card bg-lime-50 rounded-box place-items-center h-screen"},le={class:"w-full"},ne={class:"flex flex-col mt-5 space-y-4 justify-center items-center"},ae=e("div",{class:"text text-lime-800 text-center"},"请选择或者输入生成更多问题的prompts?",-1),re={class:"flex w-full flex-nowrap justify-center items-center"},ue={class:"w-full"},ie=e("label",{for:"default-search",class:"mb-2 text-sm font-medium text-gray-900 sr-only dark:text-gray-300"},"Search",-1),ce={class:"relative w-full"},de={class:"dropdown-menu"},ve={class:"bg-white rounded-lg shadow-xl px-4 relative mt-2"},fe=["onClick"],pe={href:"#",class:"flex-1"},ge={class:"text-gray-600 text-base"},me=e("div",null,[e("svg",{width:"40",height:"20",viewBox:"0 0 40 20",xmlns:"http://www.w3.org/2000/svg"},[e("line",{x1:"30",y1:"2",x2:"40",y2:"10",stroke:"#9CA3AF"}),e("line",{x1:"30",y1:"18",x2:"40",y2:"10",stroke:"#9CA3AF"}),e("line",{x1:"20",y1:"10",x2:"40",y2:"10",stroke:"#9CA3AF"})])],-1),_e={class:"flex flex-row flex-wrap gap-2"},be=["onMouseover","onMouseleave","onClick"],he={class:"btn btn-square"},xe=["disabled"],we=e("div",{class:"text text-lime-800 text-center"},"根据工具的说明生成问题",-1),ye={class:"flex flex-row justify-center items-center flex-wrap"},ke=["onClick"],Ce=e("div",{class:"divider lg:divider-horizontal"},null,-1),qe={class:"right w-2/5 h-screen grid flex-grow card bg-lime-50 rounded-box place-items-center p-6 overflow-auto"},Be=O({__name:"instructionGeneration",setup(Qe){const{selectedLLM:f,usecache:C}=A(J()),{tools_data:b}=A(K()),h=a(),l=a(""),q=a(""),x=a(!1),r=a("生成后的结果双击可以修改,也可以直接修改，支持按行的纯文本和json的数组格式"),d=a(!1),c=a(!1),p=a(!1),Q=a(),w=a();function B(){x.value=!0,c.value=!0}function L(t,o){q.value=o}function j(t){q.value=""}function D(t,o){l.value=o}async function F(){(await Z({prompt:l.value,llm:f.value})).code==0?(v.info("删除成功"),r.value="生成后的结果双击可以修改",c.value=!1,l.value=""):v.error("删除失败")}function S(t){l.value=t.prompt,r.value=t.question_content,p.value=!1,c.value=!0}function V(){const t=l.value.toLowerCase();t!=""&&(p.value=!p.value,w.value=Q.value.filter(o=>{if(o.prompt.toLowerCase().includes(t))return o}),console.log("匹配到的问题:",w.value))}async function E(){const t=await ee({keyword:"empty"});console.log(t),Q.value=t.data}async function N(){(await te({prompt:l.value,question_content:r.value,llm:f.value})).code==0?(v.info("保存成功"),r.value="生成后的结果双击可以修改",c.value=!1):v.error("保存失败")}function T(){const t={};for(const o of h.value)t[o.name]=o.prompt;return t}async function z(t){const o=T();if(!("gen_tool_question"in o)){v.error("还没有添加名字为gen_tool_question的prompt");return}d.value=!0;const s=o.gen_tool_question,n=await $({prompt:s,tool_name:t,llm:f.value,usecache:C.value});console.log("response:",n),r.value=n.data,d.value=!1,c.value=!0,l.value=t}async function I(){if(!l.value){v.error("请输入prompt，然后点击确定");return}d.value=!0;const t=await $({prompt:l.value,llm:f.value,usecache:C.value});console.log("response:",t),r.value=t.data,d.value=!1,c.value=!0}return U(async()=>{const t=await X();h.value=t.data;const o=await Y();b.value=o.data,console.log("tools_data:",b.value),await E()}),(t,o)=>(u(),i(m,null,[G(W),e("div",oe,[e("div",se,[e("div",le,[e("div",ne,[ae,e("div",re,[e("form",ue,[ie,e("div",ce,[g(e("input",{type:"search",id:"default-search","onUpdate:modelValue":o[0]||(o[0]=s=>l.value=s),onInput:V,class:"block p-4 pl-4 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"prompt",required:""},null,544),[[M,l.value]])]),g(e("div",de,[(u(!0),i(m,null,k(w.value,s=>(u(),i("div",ve,[e("div",{class:"py-4 flex items-center w-full hover:bg-gray-50",onClick:n=>S(s)},[e("a",pe,[e("div",ge,_(s.prompt),1)]),me],8,fe)]))),256))],512),[[P,p.value]])]),e("div",{class:"text-white w-96 flex flex-nowrap justify-center items-center"},[e("button",{type:"submit",onClick:I,class:"bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-4 py-2 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"},"生成"),e("button",{type:"submit",onClick:F,class:"bg-yellow-700 hover:bg-yellow-800 focus:ring-4 focus:outline-none focus:ring-yellow-300 font-medium rounded-lg text-sm px-4 py-2 dark:bg-yellow-600 dark:hover:bg-yellow-700 dark:focus:ring-yellow-800"},"删除")])]),e("div",_e,[(u(!0),i(m,null,k(h.value,(s,n)=>(u(),i("button",{class:"block text-sm ml-3 bg-slate-300 w-40 truncate hover:bg-slate-400",key:s.name,onMouseover:y=>L(n,s.prompt),onMouseleave:y=>j(),onClick:y=>D(n,s.prompt)},_(s.name),41,be))),128))])])]),g(e("button",he,[e("span",{class:R({"loading loading-spinner":d.value})},null,2)],512),[[P,d.value]]),e("div",null,[e("button",{class:"btn btn-warning",disabled:!c.value,onClick:N},"保存",8,xe)]),e("div",null,[we,e("div",ye,[(u(!0),i(m,null,k(H(b),(s,n)=>(u(),i("button",{class:"btn btn-outline btn-success btn-sm",onClick:y=>z(n),key:n},_(n),9,ke))),128))])])]),Ce,e("div",qe,[x.value?g((u(),i("textarea",{key:1,"onUpdate:modelValue":o[1]||(o[1]=s=>r.value=s),onBlur:o[2]||(o[2]=s=>x.value=!1),class:"w-full h-full"},null,544)),[[M,r.value]]):(u(),i("div",{key:0,class:"whitespace-pre-wrap",onDblclick:B},_(r.value),33))])])],64))}});export{Be as default};
