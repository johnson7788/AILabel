import{d as D,g as u,h as M,o as r,b as c,f as S,A as _,B as w,a as l,F as $,e as b,t as h,z as A,P as E,j as T,E as n}from"./index-f50d6d08.js";import{a as F}from"./axios-a342f982.js";import{G as N,C as U,_ as j,h as V}from"./navbar.vue_vue_type_script_setup_true_lang-1f4df18c.js";const G={class:"main"},z=l("h1",null," 视频转换音频，上传，转换，下载 ",-1),I={class:"my-auto"},J=["value"],O={key:0},R={class:"mt-6"},W=l("span",null,"选择1个文件：",-1),X=["value"],q={class:"loading loading-spinner"},Y=D({__name:"video2audio",setup(H){const C="https://ai.minitool.fun:15554",y=u([]),m=u(),p=u([]),o=u([]),i=u(""),k=u(!1),v=u(!1);async function L(){if(!m.value){n({title:"success",message:"需要选择1个文件"});return}v.value=!0;try{const a=await F.post(`${C}/audio/video2audio`,{video_file:m.value},{headers:V});if(a.data.code==0){n({title:"success",message:"转换成功"+a.data.data});const s=await N();y.value=s.files}else n({title:"error",message:"转换失败"+a.data.data})}catch(a){n({title:"error",message:"转换失败"+a})}v.value=!1}const x=(a,s)=>{const e=a.target;e.files&&(p.value=Array.from(e.files),o.value=p.value.map(t=>({name:t.name,progress:0})),p.value.forEach((t,d)=>{s==="image"&&!t.type.startsWith("image/")?(i.value=`文件 ${t.name} 不是图片格式，上传失败`,o.value[d].progress=-1):s==="mind"&&!["application/json","application/vnd.xmind.workbook"].includes(t.type)?(i.value=`文件 ${t.name} 不是 JSON 或 XMind 格式，上传失败`,o.value[d].progress=-1):B(t,d)}),p.value=null)},B=(a,s)=>{if(!a){n({title:"success",message:"需要选择1个文件"});return}const e=new FormData;e.append("file",a);const t={...V};delete t["Content-Type"];let d=`${C}/mind/upload_file`;F.post(d,e,{headers:{"Content-Type":"multipart/form-data",...t},onUploadProgress:g=>{o.value[s]&&(o.value[s].progress=Math.round(g.loaded*100/g.total))}}).then(g=>{const f=g.data;f.code===0?(i.value="文件上传成功",n({title:"success",message:`文件上传: ${f.msg}`}),o.value[s].progress=100):(i.value=`文件上传失败: ${f.msg}`,n({title:"success",message:`文件上传: ${f.msg}`}),o.value[s].progress=-1)}).catch(()=>{i.value="文件上传失败",o.value[s].progress=-1,n({title:"error",message:"文件上传失败，服务器异常"})})};return M(async()=>{const a=await N();y.value=a.files,k.value=await U()}),(a,s)=>(r(),c("div",G,[S(j),z,_(l("div",I,[l("input",{type:"file",class:"file-input file-input-bordered file-input-success w-full max-w-xs h-16",onChange:s[0]||(s[0]=e=>x(e,"mind"))},null,32),(r(!0),c($,null,b(o.value,(e,t)=>(r(),c("div",{key:t},[l("p",null,h(e.name)+" 上传进度: "+h(e.progress)+"%",1),l("progress",{value:e.progress,max:"100"},null,8,J)]))),128)),i.value?(r(),c("div",O,h(i.value),1)):A("",!0)],512),[[w,k.value]]),l("div",R,[W,_(l("select",{class:"select select-accent w-full max-w-xs","onUpdate:modelValue":s[1]||(s[1]=e=>m.value=e)},[(r(!0),c($,null,b(y.value,e=>(r(),c("option",{value:e.name},h(e.name),9,X))),256))],512),[[E,m.value]]),l("div",null,[l("button",{class:"btn btn-success ml-6",onClick:L},[_(l("span",q,null,512),[[w,v.value]]),_(l("span",null,"loading",512),[[w,v.value]]),T(" 转换 ")])])])]))}});export{Y as default};
