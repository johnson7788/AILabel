import{d as Q,g as d,h as X,o as $,b as G,f as H,a as t,t as x,A as f,B as h,F as J}from"./index-f50d6d08.js";import{_ as K}from"./navHeader.vue_vue_type_script_setup_true_lang-5f81fcc5.js";import{i as v}from"./index-cbf34b5d.js";import{c as R,a as U,b as W,d as j}from"./api-e233926e.js";import"./axios-a342f982.js";const Y={class:"main"},Z={class:"stats shadow"},tt={class:"stat"},et=t("div",{class:"stat-figure text-primary"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",class:"inline-block w-8 h-8 stroke-current"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})])],-1),ot=t("div",{class:"stat-title"},"总量",-1),st={class:"stat-value text-secondary"},nt=t("div",{class:"stat-desc"},"标注的总数量",-1),at={class:"stat"},lt=t("div",{class:"stat-figure text-secondary"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",class:"inline-block w-8 h-8 stroke-current"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})])],-1),ct=t("div",{class:"stat-title"},"工具数量",-1),it={class:"stat-value text-secondary"},rt=t("div",{class:"stat-desc"},"总得工具数量",-1),dt={class:"stat"},ut=t("div",{class:"stat-figure text-secondary"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",class:"inline-block w-8 h-8 stroke-current"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})])],-1),mt=t("div",{class:"stat-title"},"Sample数量",-1),_t={class:"stat-value text-secondary"},pt=t("div",{class:"stat-desc"},"问题样本数量",-1),gt=t("div",{class:"text-xl font-mono font-bold pt-0.5"}," 每个实体类型统计 ",-1),ft=[gt],ht=t("div",{class:"text-xl font-mono font-bold pt-0.5"}," 统计数据是无的占比 ",-1),vt=[ht],bt=t("div",{class:"text-xl font-mono font-bold pt-0.5"}," 是否占比统计 ",-1),yt=[bt],wt=t("div",{class:"text-xl font-mono font-bold pt-0.5"}," 标注数量统计 ",-1),xt=[wt],kt={id:"thirteen",class:"w-full h-96 my-10"},Ct={id:"countNone",class:"w-full h-96 my-10"},Bt={id:"plotSentiment",class:"w-full h-96 my-10"},At={id:"labelCount",class:"w-full h-96 my-10"},St=Q({__name:"statsEntity",setup(Dt){const z=d([]),b=d(0),k=d(0),C=d(0),B=d(!1),A=d(!1),D=d(!1),N=d(!1),y=d(["weibo-shiti0","xhs-shiti1","xhs-shiti0","xsh2-st","xsh1-st","xhs0-st"]);async function E(){N.value=!0;const s=await p();console.log(s);const n=s.map(a=>a.prompt_name),e=[...new Set(n)];console.log("标注数量用到的prompts是：",e);const o={};for(let a of s){for(let r of e)o[r]||(o[r]=0);const i=a.prompt_name;e.includes(i)&&(o[i]+=1)}console.log("得到的标注数量统计绘图数据是：",o);const c=Object.keys(o),l=Object.values(o);S(c,l)}const S=(s,n)=>{document.getElementById("labelCount").setAttribute("_echarts_instance_","");var e=document.getElementById("labelCount"),o=v(e);const c=["red","green","blue","yellow","purple","pink","orange","gray","black","brown","cyan","magenta","olive","lime","teal","navy","fuchsia","maroon","aqua","gold","silver"],l=n.map((i,r)=>({value:i,itemStyle:{color:c[r]}})),a={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"value"},yAxis:{type:"category",data:s},series:[{name:"统计",type:"bar",stack:"total",label:{show:!0},emphasis:{focus:"series"},data:l}]};a&&o.setOption(a),window.onresize=()=>{o.resize()}};async function I(){D.value=!0;const s=await p();console.log(s);let n=[];for(let a of s){const i=a.prompt_name;y.value.includes(i)&&n.push(a)}console.log("过滤后的数据是：",n);const e=["是","否"],o={};for(let a of n){for(let u of e)o[u]||(o[u]=0);const i=a.messages,r=i[i.length-1];if(r.role==="gpt"){const u=r.content;if(u!=="无"){const g=u.split(`
`);console.log(g);for(let O of g){const m=O.replace(/\(|\)/g,"").split(",");if(m.length===3){m[0].replace(/\s*/g,""),m[1].replace(/\s*/g,"");const T=m[2].replace(/\s*/g,"");o[T]+=1}}}}}console.log("得到的标签统计绘图数据是：",o);const c=Object.keys(o),l=Object.values(o);L(c,l)}const L=(s,n)=>{document.getElementById("plotSentiment").setAttribute("_echarts_instance_","");var e=document.getElementById("plotSentiment"),o=v(e);const c=["red","green","blue","yellow","purple","pink","orange"],l=n.map((i,r)=>({value:i,itemStyle:{color:c[r]}}));console.log("得到的标签统计绘图数据是：",l);const a={title:{text:"标签统计"},xAxis:{type:"category",data:s},yAxis:{type:"value"},series:[{data:l,type:"bar"}]};a&&o.setOption(a),window.onresize=()=>{o.resize()}};async function F(){A.value=!0;const s=await p();console.log(s);let n=[];for(let c of s){const l=c.prompt_name;y.value.includes(l)&&n.push(c)}const e={};for(let c of n){const l=c.messages,a=l[l.length-1];a.role==="gpt"&&(a.content==="无"?(e.无效||(e.无效=0),e.无效+=1,console.log("无效数据是",l)):(e.有效||(e.有效=0),e.有效+=1))}let o=[];for(let c in e)o.push({name:c,value:e[c]});console.log("得到的统计绘图数据是：",o),M(o)}const M=s=>{document.getElementById("countNone").setAttribute("_echarts_instance_","");var n=document.getElementById("countNone"),e=v(n);const o={title:{text:"统计标签是无的数量",subtext:"所有实体数据",left:"center"},tooltip:{trigger:"item"},legend:{orient:"vertical",left:"left"},series:[{name:"Access From",type:"pie",radius:"50%",data:s,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};o&&e.setOption(o),window.onresize=()=>{e.resize()}};async function V(){B.value=!0;const s=await p();console.log(s);let n=[];for(let l of s){const a=l.prompt_name;y.value.includes(a)&&n.push(l)}const e={};for(let l of n){const a=l.messages,i=a[a.length-1];if(i.role==="gpt"){const w=i.content;if(w!=="无"){const u=w.split(`
`);console.log(u);for(let g of u){const _=g.replace(/\(|\)/g,"").split(",");if(_.length===3){_[0].replace(/\s*/g,"");const m=_[1].replace(/\s*/g,"");_[2].replace(/\s*/g,""),e[m]||(e[m]=0),e[m]+=1}}}}}console.log("得到的统计绘图数据是：",e);const o=Object.keys(e),c=Object.values(e);q(o,c)}const q=(s,n)=>{document.getElementById("thirteen").setAttribute("_echarts_instance_","");var e=document.getElementById("thirteen"),o=v(e);const c=["red","green","blue","yellow","purple","pink","orange","gray","black","brown","cyan","magenta","olive","lime","teal","navy","fuchsia","maroon","aqua","gold","silver"],l=n.map((i,r)=>({value:i,itemStyle:{color:c[r]}})),a={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"value"},yAxis:{type:"category",data:s},series:[{name:"统计",type:"bar",stack:"total",label:{show:!0},emphasis:{focus:"series"},data:l}]};a&&o.setOption(a),window.onresize=()=>{o.resize()}};async function p(){try{return(await j({mode:"full",limit:-1})).data}catch(s){console.log(s)}}async function P(s){const n=await j({mode:"sample",limit:s});console.log(n),z.value=n.data,b.value=n.data.length}return X(async()=>{await P(200);const s=await R();b.value=s.data;const n=await U();console.log(n),k.value=Object.keys(n.data).length;const e=await W({keyword:"empty"});console.log(e),C.value=e.data.length}),(s,n)=>($(),G(J,null,[H(K),t("div",Y,[t("div",Z,[t("div",tt,[et,ot,t("div",st,x(b.value),1),nt]),t("div",at,[lt,ct,t("div",it,x(k.value),1),rt]),t("div",dt,[ut,mt,t("div",_t,x(C.value),1),pt])]),t("div",{class:"flex items-center flex-row justify-center h-20 from-teal-100 via-teal-200 to-teal-300 bg-gradient-to-br"},[t("div",{className:"rounded-3xl m-4 text-center flex flex-row w-full "},[t("button",{type:"button",onClick:V,class:"inline-flex text-white bg-gradient-to-r from-purple-500 to-pink-500 hover:bg-gradient-to-l focus:outline-none focus:ring-purple-200 dark:focus:ring-purple-800 font-medium rounded-2xl text-sm px-5 py-2.5 text-center mr-2 mb-2"},ft),t("button",{type:"button",onClick:F,class:"text-white bg-[#3b5998] hover:bg-[#3b5998]/90 focus:ring-4 focus:outline-none focus:ring-[#3b5998]/50 font-medium rounded-2xl text-sm px-5 py-2.5 text-center inline-flex items-center dark:focus:ring-[#3b5998]/55 mr-2 mb-2"},vt),t("button",{type:"button",onClick:I,class:"text-white bg-[#c4302b] hover:bg-red-500 focus:ring-4 focus:outline-none focus:ring-[#3b5998]/50 font-medium rounded-2xl text-sm px-5 py-2.5 text-center inline-flex items-center dark:focus:ring-[#3b5998]/55 mr-2 mb-2"},yt),t("button",{type:"button",onClick:E,class:"text-white bg-[#25D366] hover:bg-green-500 focus:ring-4 focus:outline-none focus:ring-[#3b5998]/50 font-medium rounded-2xl text-sm px-5 py-2.5 text-center inline-flex items-center dark:focus:ring-[#3b5998]/55 mr-2 mb-2"},xt)])]),f(t("div",kt,null,512),[[h,B.value]]),f(t("div",Ct,null,512),[[h,A.value]]),f(t("div",Bt,null,512),[[h,D.value]]),f(t("div",At,null,512),[[h,N.value]])])],64))}});export{St as default};
