import{n as R,a as $,d as U,b as X,c as Y,y as V}from"./nodrag-71d5223e.js";import{d as W,s as G}from"./transform-4a56bf00.js";import{p as H}from"./pointer-b52b12f8.js";import{c as j,j as I}from"./manyBody-52170d67.js";const S=e=>()=>e;function B(e,{sourceEvent:f,subject:u,target:p,identifier:h,active:s,x:g,y:n,dx:a,dy:v,dispatch:d}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:f,enumerable:!0,configurable:!0},subject:{value:u,enumerable:!0,configurable:!0},target:{value:p,enumerable:!0,configurable:!0},identifier:{value:h,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:g,enumerable:!0,configurable:!0},y:{value:n,enumerable:!0,configurable:!0},dx:{value:a,enumerable:!0,configurable:!0},dy:{value:v,enumerable:!0,configurable:!0},_:{value:d}})}B.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Z(e){return!e.ctrlKey&&!e.button}function k(){return this.parentNode}function _(e,f){return f??{x:e.x,y:e.y}}function tt(){return navigator.maxTouchPoints||"ontouchstart"in this}function at(){var e=Z,f=k,u=_,p=tt,h={},s=W("start","drag","end"),g=0,n,a,v,d,T=0;function i(t){t.on("mousedown.drag",D).filter(p).on("touchstart.drag",r).on("touchmove.drag",b,R).on("touchend.drag touchcancel.drag",A).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function D(t,o){if(!(d||!e.call(this,t,o))){var c=x(this,f.call(this,t,o),t,o,"mouse");c&&(G(t.view).on("mousemove.drag",E,$).on("mouseup.drag",N,$),U(t.view),X(t),v=!1,n=t.clientX,a=t.clientY,c("start",t))}}function E(t){if(Y(t),!v){var o=t.clientX-n,c=t.clientY-a;v=o*o+c*c>T}h.mouse("drag",t)}function N(t){G(t.view).on("mousemove.drag mouseup.drag",null),V(t.view,v),Y(t),h.mouse("end",t)}function r(t,o){if(e.call(this,t,o)){var c=t.changedTouches,l=f.call(this,t,o),m=c.length,y,w;for(y=0;y<m;++y)(w=x(this,l,t,o,c[y].identifier,c[y]))&&(X(t),w("start",t,c[y]))}}function b(t){var o=t.changedTouches,c=o.length,l,m;for(l=0;l<c;++l)(m=h[o[l].identifier])&&(Y(t),m("drag",t,o[l]))}function A(t){var o=t.changedTouches,c=o.length,l,m;for(d&&clearTimeout(d),d=setTimeout(function(){d=null},500),l=0;l<c;++l)(m=h[o[l].identifier])&&(X(t),m("end",t,o[l]))}function x(t,o,c,l,m,y){var w=s.copy(),z=H(y||c,o),C,F,M;if((M=u.call(t,new B("beforestart",{sourceEvent:c,target:i,identifier:m,active:g,x:z[0],y:z[1],dx:0,dy:0,dispatch:w}),l))!=null)return C=M.x-z[0]||0,F=M.y-z[1]||0,function L(q,K,Q){var O=z,P;switch(q){case"start":h[m]=L,P=g++;break;case"end":delete h[m],--g;case"drag":z=H(Q||K,o),P=g;break}w.call(q,t,new B(q,{sourceEvent:K,subject:M,target:i,identifier:m,active:P,x:z[0]+C,y:z[1]+F,dx:z[0]-O[0],dy:z[1]-O[1],dispatch:w}),l)}}return i.filter=function(t){return arguments.length?(e=typeof t=="function"?t:S(!!t),i):e},i.container=function(t){return arguments.length?(f=typeof t=="function"?t:S(t),i):f},i.subject=function(t){return arguments.length?(u=typeof t=="function"?t:S(t),i):u},i.touchable=function(t){return arguments.length?(p=typeof t=="function"?t:S(!!t),i):p},i.on=function(){var t=s.on.apply(s,arguments);return t===s?i:t},i.clickDistance=function(t){return arguments.length?(T=(t=+t)*t,i):Math.sqrt(T)},i}function nt(e){return e.index}function J(e,f){var u=e.get(f);if(!u)throw new Error("node not found: "+f);return u}function it(e){var f=nt,u=T,p,h=j(30),s,g,n,a,v,d=1;e==null&&(e=[]);function T(r){return 1/Math.min(n[r.source.index],n[r.target.index])}function i(r){for(var b=0,A=e.length;b<d;++b)for(var x=0,t,o,c,l,m,y,w;x<A;++x)t=e[x],o=t.source,c=t.target,l=c.x+c.vx-o.x-o.vx||I(v),m=c.y+c.vy-o.y-o.vy||I(v),y=Math.sqrt(l*l+m*m),y=(y-s[x])/y*r*p[x],l*=y,m*=y,c.vx-=l*(w=a[x]),c.vy-=m*w,o.vx+=l*(w=1-w),o.vy+=m*w}function D(){if(g){var r,b=g.length,A=e.length,x=new Map(g.map((o,c)=>[f(o,c,g),o])),t;for(r=0,n=new Array(b);r<A;++r)t=e[r],t.index=r,typeof t.source!="object"&&(t.source=J(x,t.source)),typeof t.target!="object"&&(t.target=J(x,t.target)),n[t.source.index]=(n[t.source.index]||0)+1,n[t.target.index]=(n[t.target.index]||0)+1;for(r=0,a=new Array(A);r<A;++r)t=e[r],a[r]=n[t.source.index]/(n[t.source.index]+n[t.target.index]);p=new Array(A),E(),s=new Array(A),N()}}function E(){if(g)for(var r=0,b=e.length;r<b;++r)p[r]=+u(e[r],r,e)}function N(){if(g)for(var r=0,b=e.length;r<b;++r)s[r]=+h(e[r],r,e)}return i.initialize=function(r,b){g=r,v=b,D()},i.links=function(r){return arguments.length?(e=r,D(),i):e},i.id=function(r){return arguments.length?(f=r,i):f},i.iterations=function(r){return arguments.length?(d=+r,i):d},i.strength=function(r){return arguments.length?(u=typeof r=="function"?r:j(+r),E(),i):u},i.distance=function(r){return arguments.length?(h=typeof r=="function"?r:j(+r),N(),i):h},i}function ct(e){var f=j(.1),u,p,h;typeof e!="function"&&(e=j(e==null?0:+e));function s(n){for(var a=0,v=u.length,d;a<v;++a)d=u[a],d.vx+=(h[a]-d.x)*p[a]*n}function g(){if(u){var n,a=u.length;for(p=new Array(a),h=new Array(a),n=0;n<a;++n)p[n]=isNaN(h[n]=+e(u[n],n,u))?0:+f(u[n],n,u)}}return s.initialize=function(n){u=n,g()},s.strength=function(n){return arguments.length?(f=typeof n=="function"?n:j(+n),g(),s):f},s.x=function(n){return arguments.length?(e=typeof n=="function"?n:j(+n),g(),s):e},s}function ft(e){var f=j(.1),u,p,h;typeof e!="function"&&(e=j(e==null?0:+e));function s(n){for(var a=0,v=u.length,d;a<v;++a)d=u[a],d.vy+=(h[a]-d.y)*p[a]*n}function g(){if(u){var n,a=u.length;for(p=new Array(a),h=new Array(a),n=0;n<a;++n)p[n]=isNaN(h[n]=+e(u[n],n,u))?0:+f(u[n],n,u)}}return s.initialize=function(n){u=n,g()},s.strength=function(n){return arguments.length?(f=typeof n=="function"?n:j(+n),g(),s):f},s.y=function(n){return arguments.length?(e=typeof n=="function"?n:j(+n),g(),s):e},s}export{at as d,it as l,ct as x,ft as y};
