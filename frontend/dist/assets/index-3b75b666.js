import{a as b}from"./axios-a342f982.js";import{_ as z,g as i,k as D,h as F,E as o,r,o as v,b as g,a as l,f as d,w as h,F as x,e as $,l as V,j as C,t as E,p as P,q as j,s as q}from"./index-f50d6d08.js";const k=p=>(j("data-v-3055304a"),p=p(),q(),p),L=k(()=>l("div",{class:"title"},"图片理解",-1)),O={class:"main"},A={class:"operate"},G=k(()=>l("div",{class:"tips"},"上传1张图片或者给定图片的url",-1)),H={class:"upload"},J={class:"options"},K={class:"modelName"},Q=["src"],R={__name:"index",setup(p){const f=i(""),m=i("ram_plus"),c=i(""),s=i(!1),I=[{value:"ram_plus",label:"ramPlus"},{value:"blip",label:"blip"}];D(f,async e=>{console.log("输入的新url是",e),e&&(s.value=!0,b.post("http://192.168.50.209:6351/api/imgurl",{url:e}).then(a=>{console.log(`statusCode: ${a.status}`),console.log("返回的结果是",a),a.data.code===0?(o({message:"url图片上传成功",type:"info"}),c.value=a.data.data.name):o({message:`url图片上传失败，识别原因是: ${a.data.msg}`,type:"error"})}).catch(a=>{console.error(a),V.error("图片链接错误,请检查链接是否正确")}).finally(()=>{s.value=!1}))});const _=i([]);F(async()=>{await b.post("http://192.168.50.209:6351/api/list").then(e=>{if(console.log(`statusCode: ${e.status}`),console.log("返回的结果是",e),e.data.code!==0){o({message:`获取已处理的图片失败，识别原因是: ${e.data.msg}`,type:"error"});return}e.data.data.forEach(n=>{_.value.push({model:n.model,image:`http://192.168.50.209:6351/${n.image}`,result:n.result})})}).catch(e=>{console.error(e),o({message:"后台服务器连接失败",type:"error"})})});const N=()=>{if(!c.value){o({message:"您好像还么有上传图片呢！",type:"error"});return}s.value=!0,console.log("上传了新图片，获取新的图片结果"),b.post("http://192.168.50.209:6351/api/predict",{name:c.value,model:m.value}).then(e=>{console.log(`statusCode: ${e.status}`),console.log("返回的结果是",e),_.value.push({model:m.value,image:`http://192.168.50.209:6351/${c.value}`,result:e.data.data}),e.data.code===0?o({message:`图片处理成功,共显示${_.value.length}张图片`,type:"info"}):o({message:`图片处理失败，识别原因是: ${e.data.msg}`,type:"error"})}).catch(e=>{console.error(e)}).finally(()=>{s.value=!1})},S=(e,a)=>{V.warning(`The limit is 3, you selected ${e.length} files this time, add up to ${e.length+a.length} totally`)},w=()=>{o({message:"图片上传失败，请联系管理员",type:"error"})},B=e=>{console.log("收到返回的信息",e);const u=e.data.name;c.value=u};return(e,a)=>{const u=r("el-input"),n=r("el-button"),M=r("el-upload"),T=r("el-option"),U=r("el-select");return v(),g(x,null,[L,l("div",O,[l("div",A,[G,l("div",H,[d(u,{class:"urlInput",modelValue:f.value,"onUpdate:modelValue":a[0]||(a[0]=t=>f.value=t),placeholder:"输入url"},null,8,["modelValue"]),d(M,{class:"fileUpload",limit:1,"on-exceed":S,"on-success":B,"on-error":w,action:"http://192.168.50.209:6351/api/upload",method:"POST",enctype:"multipart/form-data"},{default:h(()=>[d(n,{type:"primary",disabled:s.value},{default:h(()=>[C("上传图片")]),_:1},8,["disabled"])]),_:1})]),l("div",J,[d(U,{modelValue:m.value,"onUpdate:modelValue":a[1]||(a[1]=t=>m.value=t),class:"selectModel",placeholder:"选择模型",size:"default",style:{width:"250px"}},{default:h(()=>[(v(),g(x,null,$(I,t=>d(T,{key:t.value,label:t.label,value:t.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),d(n,{class:"button",onClick:N,type:"primary",disabled:s.value},{default:h(()=>[C("确定")]),_:1},8,["disabled"])])]),(v(!0),g(x,null,$(_.value,(t,y)=>(v(),g("div",{class:"display",key:y},[l("div",K,E(t.model),1),l("img",{class:"image",src:t.image,alt:""},null,8,Q),l("div",{class:P(["result",{odd:y%2===1,evenly:y%2===0}])},E(t.result),3)]))),128))])],64)}}},Y=z(R,[["__scopeId","data-v-3055304a"]]);export{Y as default};
